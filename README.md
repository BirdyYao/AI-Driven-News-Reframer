# AI-Driven News Reframer

An automated solution for customized news article reframing and rewriting, driven by AI technology.

## Python Version

**Python 3.10.18**

## Project Directory Structure

```
auto-rewriter/
├── docs/                           # Documentation
│   └── AI-Driven News Reframer Design.md
├── instance/                       # Instance-specific files
│   └── uploads/                    # File uploads directory
├── rewriter/                       # Main application package
│   ├── __init__.py                 # Flask app factory
│   ├── session_manager.py          # Session management
│   ├── task.py                     # Task handling blueprint
│   ├── util.py                     # Utility functions
│   ├── gemini/                     # Google Gemini integration
│   │   ├── rewriting_client.py     # Gemini API client
│   │   └── prompt.txt              # AI prompts
│   ├── static/                     # Static assets
│   │   └── style.css
│   └── templates/                  # HTML templates
│       ├── index.html              # Welcome page
│       ├── new_task.html           # Task creation
│       ├── add_article.html        # Article input
│       ├── add_instruction.html    # Instruction input
│       └── view_task.html          # Task results
├── requirements.txt                # Python dependencies
└── README.md                       # This file
```

## How to Run Locally

### 1. Install Dependencies

Install the required Python packages using pip:

```bash
pip install -r requirements.txt
```

This will install:
- Flask==2.3.3 (Web framework)
- google-genai==0.3.0 (Google Gemini API client)
- gunicorn==21.2.0 (Production WSGI server)

### 2. Set Up Environment Variables

Create a `.env` file in the project root and add the following:

```bash
# Google Gemini API Key (required)
GEMINI_API_KEY=your_api_key_here

# Flask Secret Key (for session management)
SECRET_KEY=your_secret_key_here
```

To generate a secure secret key, run:
```bash
python -c "import secrets; print(secrets.token_hex(32))"
```

### 3. Run the Application

Start the Flask development server:

```bash
flask --app rewriter run
```

The application will be available at `http://localhost:5000`

## Production Deployment on Render

This project is configured for easy deployment on [Render](https://render.com) using the included `render.yaml` file.

### Method 1: Automatic Deployment (Recommended)

1. **Push to GitHub**
   ```bash
   git add .
   git commit -m "Prepare for Render deployment"
   git push origin main
   ```

2. **Connect to Render**
   - Go to [Render Dashboard](https://dashboard.render.com/)
   - Click "New +" and select "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml` and configure your service

3. **Configure Environment Variables**
   - In the Render dashboard, go to your web service
   - Navigate to "Environment" section
   - Add the following environment variable:
     - `GEMINI_API_KEY`: Your Google Gemini API key (get it from [Google AI Studio](https://makersuite.google.com/app/apikey))
   - Note: `SECRET_KEY` will be automatically generated by Render

4. **Deploy**
   - Click "Create Web Service"
   - Render will build and deploy your application
   - Your app will be live at: `https://auto-rewriter.onrender.com` (or your custom domain)

### Method 2: Manual Deployment

1. **Create New Web Service**
   - Go to [Render Dashboard](https://dashboard.render.com/)
   - Click "New +" and select "Web Service"
   - Connect your GitHub repository

2. **Configure Build Settings**
   - **Name**: `auto-rewriter`
   - **Environment**: `Python 3`
   - **Region**: Choose your preferred region
   - **Branch**: `main`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `gunicorn --bind 0.0.0.0:$PORT --workers 2 --timeout 120 'rewriter:create_app()'`

3. **Set Environment Variables**
   - Click "Advanced" and add:
     - `PYTHON_VERSION`: `3.10.18`
     - `GEMINI_API_KEY`: Your Google Gemini API key
     - `SECRET_KEY`: Generate with `python -c "import secrets; print(secrets.token_hex(32))"`

4. **Add Persistent Disk (Important!)**
   - In the service settings, go to "Disks"
   - Click "Add Disk"
   - **Name**: `uploads`
   - **Mount Path**: `/opt/render/project/src/instance`
   - **Size**: 1 GB (or as needed)
   - This ensures uploaded files persist across deployments

5. **Deploy**
   - Click "Create Web Service"
   - Wait for the build to complete

### Post-Deployment

- **Free Tier Considerations**:
  - Services on the free tier spin down after 15 minutes of inactivity
  - First request after inactivity may take 30-60 seconds (cold start)
  - Consider upgrading to a paid plan for production use

- **Monitoring**:
  - View logs in the Render dashboard under "Logs"
  - Monitor service health under "Metrics"

- **Custom Domain** (Optional):
  - Go to "Settings" → "Custom Domain"
  - Add your domain and configure DNS settings

### Troubleshooting

- **Build fails**: Check that `requirements.txt` is up to date
- **App crashes**: Review logs in Render dashboard for errors
- **Missing API key**: Ensure `GEMINI_API_KEY` is set in environment variables
- **File uploads not persisting**: Verify persistent disk is mounted at `/opt/render/project/src/instance`

## Basic Usage

### 1. Welcome Page
- Navigate to `http://localhost:5000`
- Click "Start" to begin creating a new task

### 2. Create a New Task
- **Add Articles**: Input news articles using one of these methods:
  - Paste text directly into the text input box
  - Upload a PDF file
  - Paste a web URL
- **Add Custom Instructions**: Provide specific reframing instructions for the AI
- Submit the task for processing

### 3. View Results
- Monitor task progress in real-time
- View the reframed article generated by Google Gemini
- Optionally include AI-generated images in the final output
- Download results in plain text or PDF format
